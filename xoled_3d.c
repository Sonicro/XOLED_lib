#include "xoled_3d.h"
#include "xoled_core.h"
#include "xoled_sintbl.h" 
#include "string.h"
#include "xoled_basedraw.h"

//////////////////////////////////////////////////////////////////////////////////	 
//代码转自MacroXu <kk20y@yahoo.com.cn>,AVR S65 3D Project
//把原来的绝大部分浮点运算改为整形运算,并将原来的sin,cos函数换为查表法,以提高速度
//优化后,速度提升约12倍	
//ALIENTEK战舰STM32开发板
//3D 代码	   
//正点原子@ALIENTEK
//技术论坛:www.openedv.com
//修改日期:2012/10/3
//版本：V1.0		       								  
////////////////////////////////////////////////////////////////////////////////// 	   
const TU8 asc2_1206[95][12]={
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*" ",0*/
{0x00,0x00,0x00,0x00,0x3F,0x40,0x00,0x00,0x00,0x00,0x00,0x00},/*"!",1*/
{0x00,0x00,0x30,0x00,0x40,0x00,0x30,0x00,0x40,0x00,0x00,0x00},/*""",2*/
{0x09,0x00,0x0B,0xC0,0x3D,0x00,0x0B,0xC0,0x3D,0x00,0x09,0x00},/*"#",3*/
{0x18,0xC0,0x24,0x40,0x7F,0xE0,0x22,0x40,0x31,0x80,0x00,0x00},/*"$",4*/
{0x18,0x00,0x24,0xC0,0x1B,0x00,0x0D,0x80,0x32,0x40,0x01,0x80},/*"%",5*/
{0x03,0x80,0x1C,0x40,0x27,0x40,0x1C,0x80,0x07,0x40,0x00,0x40},/*"&",6*/
{0x10,0x00,0x60,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"'",7*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x1F,0x80,0x20,0x40,0x40,0x20},/*"(",8*/
{0x00,0x00,0x40,0x20,0x20,0x40,0x1F,0x80,0x00,0x00,0x00,0x00},/*")",9*/
{0x09,0x00,0x06,0x00,0x1F,0x80,0x06,0x00,0x09,0x00,0x00,0x00},/*"*",10*/
{0x04,0x00,0x04,0x00,0x3F,0x80,0x04,0x00,0x04,0x00,0x00,0x00},/*"+",11*/
{0x00,0x10,0x00,0x60,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*",",12*/
{0x04,0x00,0x04,0x00,0x04,0x00,0x04,0x00,0x04,0x00,0x00,0x00},/*"-",13*/
{0x00,0x00,0x00,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*".",14*/
{0x00,0x20,0x01,0xC0,0x06,0x00,0x38,0x00,0x40,0x00,0x00,0x00},/*"/",15*/
{0x1F,0x80,0x20,0x40,0x20,0x40,0x20,0x40,0x1F,0x80,0x00,0x00},/*"0",16*/
{0x00,0x00,0x10,0x40,0x3F,0xC0,0x00,0x40,0x00,0x00,0x00,0x00},/*"1",17*/
{0x18,0xC0,0x21,0x40,0x22,0x40,0x24,0x40,0x18,0x40,0x00,0x00},/*"2",18*/
{0x10,0x80,0x20,0x40,0x24,0x40,0x24,0x40,0x1B,0x80,0x00,0x00},/*"3",19*/
{0x02,0x00,0x0D,0x00,0x11,0x00,0x3F,0xC0,0x01,0x40,0x00,0x00},/*"4",20*/
{0x3C,0x80,0x24,0x40,0x24,0x40,0x24,0x40,0x23,0x80,0x00,0x00},/*"5",21*/
{0x1F,0x80,0x24,0x40,0x24,0x40,0x34,0x40,0x03,0x80,0x00,0x00},/*"6",22*/
{0x30,0x00,0x20,0x00,0x27,0xC0,0x38,0x00,0x20,0x00,0x00,0x00},/*"7",23*/
{0x1B,0x80,0x24,0x40,0x24,0x40,0x24,0x40,0x1B,0x80,0x00,0x00},/*"8",24*/
{0x1C,0x00,0x22,0xC0,0x22,0x40,0x22,0x40,0x1F,0x80,0x00,0x00},/*"9",25*/
{0x00,0x00,0x00,0x00,0x08,0x40,0x00,0x00,0x00,0x00,0x00,0x00},/*":",26*/
{0x00,0x00,0x00,0x00,0x04,0x60,0x00,0x00,0x00,0x00,0x00,0x00},/*";",27*/
{0x00,0x00,0x04,0x00,0x0A,0x00,0x11,0x00,0x20,0x80,0x40,0x40},/*"<",28*/
{0x09,0x00,0x09,0x00,0x09,0x00,0x09,0x00,0x09,0x00,0x00,0x00},/*"=",29*/
{0x00,0x00,0x40,0x40,0x20,0x80,0x11,0x00,0x0A,0x00,0x04,0x00},/*">",30*/
{0x18,0x00,0x20,0x00,0x23,0x40,0x24,0x00,0x18,0x00,0x00,0x00},/*"?",31*/
{0x1F,0x80,0x20,0x40,0x27,0x40,0x29,0x40,0x1F,0x40,0x00,0x00},/*"@",32*/
{0x00,0x40,0x07,0xC0,0x39,0x00,0x0F,0x00,0x01,0xC0,0x00,0x40},/*"A",33*/
{0x20,0x40,0x3F,0xC0,0x24,0x40,0x24,0x40,0x1B,0x80,0x00,0x00},/*"B",34*/
{0x1F,0x80,0x20,0x40,0x20,0x40,0x20,0x40,0x30,0x80,0x00,0x00},/*"C",35*/
{0x20,0x40,0x3F,0xC0,0x20,0x40,0x20,0x40,0x1F,0x80,0x00,0x00},/*"D",36*/
{0x20,0x40,0x3F,0xC0,0x24,0x40,0x2E,0x40,0x30,0xC0,0x00,0x00},/*"E",37*/
{0x20,0x40,0x3F,0xC0,0x24,0x40,0x2E,0x00,0x30,0x00,0x00,0x00},/*"F",38*/
{0x0F,0x00,0x10,0x80,0x20,0x40,0x22,0x40,0x33,0x80,0x02,0x00},/*"G",39*/
{0x20,0x40,0x3F,0xC0,0x04,0x00,0x04,0x00,0x3F,0xC0,0x20,0x40},/*"H",40*/
{0x20,0x40,0x20,0x40,0x3F,0xC0,0x20,0x40,0x20,0x40,0x00,0x00},/*"I",41*/
{0x00,0x60,0x20,0x20,0x20,0x20,0x3F,0xC0,0x20,0x00,0x20,0x00},/*"J",42*/
{0x20,0x40,0x3F,0xC0,0x24,0x40,0x0B,0x00,0x30,0xC0,0x20,0x40},/*"K",43*/
{0x20,0x40,0x3F,0xC0,0x20,0x40,0x00,0x40,0x00,0x40,0x00,0xC0},/*"L",44*/
{0x3F,0xC0,0x3C,0x00,0x03,0xC0,0x3C,0x00,0x3F,0xC0,0x00,0x00},/*"M",45*/
{0x20,0x40,0x3F,0xC0,0x0C,0x40,0x23,0x00,0x3F,0xC0,0x20,0x00},/*"N",46*/
{0x1F,0x80,0x20,0x40,0x20,0x40,0x20,0x40,0x1F,0x80,0x00,0x00},/*"O",47*/
{0x20,0x40,0x3F,0xC0,0x24,0x40,0x24,0x00,0x18,0x00,0x00,0x00},/*"P",48*/
{0x1F,0x80,0x21,0x40,0x21,0x40,0x20,0xE0,0x1F,0xA0,0x00,0x00},/*"Q",49*/
{0x20,0x40,0x3F,0xC0,0x24,0x40,0x26,0x00,0x19,0xC0,0x00,0x40},/*"R",50*/
{0x18,0xC0,0x24,0x40,0x24,0x40,0x22,0x40,0x31,0x80,0x00,0x00},/*"S",51*/
{0x30,0x00,0x20,0x40,0x3F,0xC0,0x20,0x40,0x30,0x00,0x00,0x00},/*"T",52*/
{0x20,0x00,0x3F,0x80,0x00,0x40,0x00,0x40,0x3F,0x80,0x20,0x00},/*"U",53*/
{0x20,0x00,0x3E,0x00,0x01,0xC0,0x07,0x00,0x38,0x00,0x20,0x00},/*"V",54*/
{0x38,0x00,0x07,0xC0,0x3C,0x00,0x07,0xC0,0x38,0x00,0x00,0x00},/*"W",55*/
{0x20,0x40,0x39,0xC0,0x06,0x00,0x39,0xC0,0x20,0x40,0x00,0x00},/*"X",56*/
{0x20,0x00,0x38,0x40,0x07,0xC0,0x38,0x40,0x20,0x00,0x00,0x00},/*"Y",57*/
{0x30,0x40,0x21,0xC0,0x26,0x40,0x38,0x40,0x20,0xC0,0x00,0x00},/*"Z",58*/
{0x00,0x00,0x00,0x00,0x7F,0xE0,0x40,0x20,0x40,0x20,0x00,0x00},/*"[",59*/
{0x00,0x00,0x70,0x00,0x0C,0x00,0x03,0x80,0x00,0x40,0x00,0x00},/*"\",60*/
{0x00,0x00,0x40,0x20,0x40,0x20,0x7F,0xE0,0x00,0x00,0x00,0x00},/*"]",61*/
{0x00,0x00,0x20,0x00,0x40,0x00,0x20,0x00,0x00,0x00,0x00,0x00},/*"^",62*/
{0x00,0x10,0x00,0x10,0x00,0x10,0x00,0x10,0x00,0x10,0x00,0x10},/*"_",63*/
{0x00,0x00,0x00,0x00,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"`",64*/
{0x00,0x00,0x02,0x80,0x05,0x40,0x05,0x40,0x03,0xC0,0x00,0x40},/*"a",65*/
{0x20,0x00,0x3F,0xC0,0x04,0x40,0x04,0x40,0x03,0x80,0x00,0x00},/*"b",66*/
{0x00,0x00,0x03,0x80,0x04,0x40,0x04,0x40,0x06,0x40,0x00,0x00},/*"c",67*/
{0x00,0x00,0x03,0x80,0x04,0x40,0x24,0x40,0x3F,0xC0,0x00,0x40},/*"d",68*/
{0x00,0x00,0x03,0x80,0x05,0x40,0x05,0x40,0x03,0x40,0x00,0x00},/*"e",69*/
{0x00,0x00,0x04,0x40,0x1F,0xC0,0x24,0x40,0x24,0x40,0x20,0x00},/*"f",70*/
{0x00,0x00,0x02,0xE0,0x05,0x50,0x05,0x50,0x06,0x50,0x04,0x20},/*"g",71*/
{0x20,0x40,0x3F,0xC0,0x04,0x40,0x04,0x00,0x03,0xC0,0x00,0x40},/*"h",72*/
{0x00,0x00,0x04,0x40,0x27,0xC0,0x00,0x40,0x00,0x00,0x00,0x00},/*"i",73*/
{0x00,0x10,0x00,0x10,0x04,0x10,0x27,0xE0,0x00,0x00,0x00,0x00},/*"j",74*/
{0x20,0x40,0x3F,0xC0,0x01,0x40,0x07,0x00,0x04,0xC0,0x04,0x40},/*"k",75*/
{0x20,0x40,0x20,0x40,0x3F,0xC0,0x00,0x40,0x00,0x40,0x00,0x00},/*"l",76*/
{0x07,0xC0,0x04,0x00,0x07,0xC0,0x04,0x00,0x03,0xC0,0x00,0x00},/*"m",77*/
{0x04,0x40,0x07,0xC0,0x04,0x40,0x04,0x00,0x03,0xC0,0x00,0x40},/*"n",78*/
{0x00,0x00,0x03,0x80,0x04,0x40,0x04,0x40,0x03,0x80,0x00,0x00},/*"o",79*/
{0x04,0x10,0x07,0xF0,0x04,0x50,0x04,0x40,0x03,0x80,0x00,0x00},/*"p",80*/
{0x00,0x00,0x03,0x80,0x04,0x40,0x04,0x50,0x07,0xF0,0x00,0x10},/*"q",81*/
{0x04,0x40,0x07,0xC0,0x02,0x40,0x04,0x00,0x04,0x00,0x00,0x00},/*"r",82*/
{0x00,0x00,0x06,0x40,0x05,0x40,0x05,0x40,0x04,0xC0,0x00,0x00},/*"s",83*/
{0x00,0x00,0x04,0x00,0x1F,0x80,0x04,0x40,0x00,0x40,0x00,0x00},/*"t",84*/
{0x04,0x00,0x07,0x80,0x00,0x40,0x04,0x40,0x07,0xC0,0x00,0x40},/*"u",85*/
{0x04,0x00,0x07,0x00,0x04,0xC0,0x01,0x80,0x06,0x00,0x04,0x00},/*"v",86*/
{0x06,0x00,0x01,0xC0,0x07,0x00,0x01,0xC0,0x06,0x00,0x00,0x00},/*"w",87*/
{0x04,0x40,0x06,0xC0,0x01,0x00,0x06,0xC0,0x04,0x40,0x00,0x00},/*"x",88*/
{0x04,0x10,0x07,0x10,0x04,0xE0,0x01,0x80,0x06,0x00,0x04,0x00},/*"y",89*/
{0x00,0x00,0x04,0x40,0x05,0xC0,0x06,0x40,0x04,0x40,0x00,0x00},/*"z",90*/
{0x00,0x00,0x00,0x00,0x04,0x00,0x7B,0xE0,0x40,0x20,0x00,0x00},/*"{",91*/
{0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xF0,0x00,0x00,0x00,0x00},/*"|",92*/
{0x00,0x00,0x40,0x20,0x7B,0xE0,0x04,0x00,0x00,0x00,0x00,0x00},/*"}",93*/
{0x40,0x00,0x80,0x00,0x40,0x00,0x20,0x00,0x20,0x00,0x40,0x00},/*"~",94*/
}; 
const TU8 asc2_1608[95][16]={	  
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*" ",0*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x1F,0xCC,0x00,0x0C,0x00,0x00,0x00,0x00,0x00,0x00},/*"!",1*/
{0x00,0x00,0x08,0x00,0x30,0x00,0x60,0x00,0x08,0x00,0x30,0x00,0x60,0x00,0x00,0x00},/*""",2*/
{0x02,0x20,0x03,0xFC,0x1E,0x20,0x02,0x20,0x03,0xFC,0x1E,0x20,0x02,0x20,0x00,0x00},/*"#",3*/
{0x00,0x00,0x0E,0x18,0x11,0x04,0x3F,0xFF,0x10,0x84,0x0C,0x78,0x00,0x00,0x00,0x00},/*"$",4*/
{0x0F,0x00,0x10,0x84,0x0F,0x38,0x00,0xC0,0x07,0x78,0x18,0x84,0x00,0x78,0x00,0x00},/*"%",5*/
{0x00,0x78,0x0F,0x84,0x10,0xC4,0x11,0x24,0x0E,0x98,0x00,0xE4,0x00,0x84,0x00,0x08},/*"&",6*/
{0x08,0x00,0x68,0x00,0x70,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"'",7*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x07,0xE0,0x18,0x18,0x20,0x04,0x40,0x02,0x00,0x00},/*"(",8*/
{0x00,0x00,0x40,0x02,0x20,0x04,0x18,0x18,0x07,0xE0,0x00,0x00,0x00,0x00,0x00,0x00},/*")",9*/
{0x02,0x40,0x02,0x40,0x01,0x80,0x0F,0xF0,0x01,0x80,0x02,0x40,0x02,0x40,0x00,0x00},/*"*",10*/
{0x00,0x80,0x00,0x80,0x00,0x80,0x0F,0xF8,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x00},/*"+",11*/
{0x00,0x01,0x00,0x0D,0x00,0x0E,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*",",12*/
{0x00,0x00,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80},/*"-",13*/
{0x00,0x00,0x00,0x0C,0x00,0x0C,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*".",14*/
{0x00,0x00,0x00,0x06,0x00,0x18,0x00,0x60,0x01,0x80,0x06,0x00,0x18,0x00,0x20,0x00},/*"/",15*/
{0x00,0x00,0x07,0xF0,0x08,0x08,0x10,0x04,0x10,0x04,0x08,0x08,0x07,0xF0,0x00,0x00},/*"0",16*/
{0x00,0x00,0x08,0x04,0x08,0x04,0x1F,0xFC,0x00,0x04,0x00,0x04,0x00,0x00,0x00,0x00},/*"1",17*/
{0x00,0x00,0x0E,0x0C,0x10,0x14,0x10,0x24,0x10,0x44,0x11,0x84,0x0E,0x0C,0x00,0x00},/*"2",18*/
{0x00,0x00,0x0C,0x18,0x10,0x04,0x11,0x04,0x11,0x04,0x12,0x88,0x0C,0x70,0x00,0x00},/*"3",19*/
{0x00,0x00,0x00,0xE0,0x03,0x20,0x04,0x24,0x08,0x24,0x1F,0xFC,0x00,0x24,0x00,0x00},/*"4",20*/
{0x00,0x00,0x1F,0x98,0x10,0x84,0x11,0x04,0x11,0x04,0x10,0x88,0x10,0x70,0x00,0x00},/*"5",21*/
{0x00,0x00,0x07,0xF0,0x08,0x88,0x11,0x04,0x11,0x04,0x18,0x88,0x00,0x70,0x00,0x00},/*"6",22*/
{0x00,0x00,0x1C,0x00,0x10,0x00,0x10,0xFC,0x13,0x00,0x1C,0x00,0x10,0x00,0x00,0x00},/*"7",23*/
{0x00,0x00,0x0E,0x38,0x11,0x44,0x10,0x84,0x10,0x84,0x11,0x44,0x0E,0x38,0x00,0x00},/*"8",24*/
{0x00,0x00,0x07,0x00,0x08,0x8C,0x10,0x44,0x10,0x44,0x08,0x88,0x07,0xF0,0x00,0x00},/*"9",25*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x0C,0x03,0x0C,0x00,0x00,0x00,0x00,0x00,0x00},/*":",26*/
{0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*";",27*/
{0x00,0x00,0x00,0x80,0x01,0x40,0x02,0x20,0x04,0x10,0x08,0x08,0x10,0x04,0x00,0x00},/*"<",28*/
{0x02,0x20,0x02,0x20,0x02,0x20,0x02,0x20,0x02,0x20,0x02,0x20,0x02,0x20,0x00,0x00},/*"=",29*/
{0x00,0x00,0x10,0x04,0x08,0x08,0x04,0x10,0x02,0x20,0x01,0x40,0x00,0x80,0x00,0x00},/*">",30*/
{0x00,0x00,0x0E,0x00,0x12,0x00,0x10,0x0C,0x10,0x6C,0x10,0x80,0x0F,0x00,0x00,0x00},/*"?",31*/
{0x03,0xE0,0x0C,0x18,0x13,0xE4,0x14,0x24,0x17,0xC4,0x08,0x28,0x07,0xD0,0x00,0x00},/*"@",32*/
{0x00,0x04,0x00,0x3C,0x03,0xC4,0x1C,0x40,0x07,0x40,0x00,0xE4,0x00,0x1C,0x00,0x04},/*"A",33*/
{0x10,0x04,0x1F,0xFC,0x11,0x04,0x11,0x04,0x11,0x04,0x0E,0x88,0x00,0x70,0x00,0x00},/*"B",34*/
{0x03,0xE0,0x0C,0x18,0x10,0x04,0x10,0x04,0x10,0x04,0x10,0x08,0x1C,0x10,0x00,0x00},/*"C",35*/
{0x10,0x04,0x1F,0xFC,0x10,0x04,0x10,0x04,0x10,0x04,0x08,0x08,0x07,0xF0,0x00,0x00},/*"D",36*/
{0x10,0x04,0x1F,0xFC,0x11,0x04,0x11,0x04,0x17,0xC4,0x10,0x04,0x08,0x18,0x00,0x00},/*"E",37*/
{0x10,0x04,0x1F,0xFC,0x11,0x04,0x11,0x00,0x17,0xC0,0x10,0x00,0x08,0x00,0x00,0x00},/*"F",38*/
{0x03,0xE0,0x0C,0x18,0x10,0x04,0x10,0x04,0x10,0x44,0x1C,0x78,0x00,0x40,0x00,0x00},/*"G",39*/
{0x10,0x04,0x1F,0xFC,0x10,0x84,0x00,0x80,0x00,0x80,0x10,0x84,0x1F,0xFC,0x10,0x04},/*"H",40*/
{0x00,0x00,0x10,0x04,0x10,0x04,0x1F,0xFC,0x10,0x04,0x10,0x04,0x00,0x00,0x00,0x00},/*"I",41*/
{0x00,0x03,0x00,0x01,0x10,0x01,0x10,0x01,0x1F,0xFE,0x10,0x00,0x10,0x00,0x00,0x00},/*"J",42*/
{0x10,0x04,0x1F,0xFC,0x11,0x04,0x03,0x80,0x14,0x64,0x18,0x1C,0x10,0x04,0x00,0x00},/*"K",43*/
{0x10,0x04,0x1F,0xFC,0x10,0x04,0x00,0x04,0x00,0x04,0x00,0x04,0x00,0x0C,0x00,0x00},/*"L",44*/
{0x10,0x04,0x1F,0xFC,0x1F,0x00,0x00,0xFC,0x1F,0x00,0x1F,0xFC,0x10,0x04,0x00,0x00},/*"M",45*/
{0x10,0x04,0x1F,0xFC,0x0C,0x04,0x03,0x00,0x00,0xE0,0x10,0x18,0x1F,0xFC,0x10,0x00},/*"N",46*/
{0x07,0xF0,0x08,0x08,0x10,0x04,0x10,0x04,0x10,0x04,0x08,0x08,0x07,0xF0,0x00,0x00},/*"O",47*/
{0x10,0x04,0x1F,0xFC,0x10,0x84,0x10,0x80,0x10,0x80,0x10,0x80,0x0F,0x00,0x00,0x00},/*"P",48*/
{0x07,0xF0,0x08,0x18,0x10,0x24,0x10,0x24,0x10,0x1C,0x08,0x0A,0x07,0xF2,0x00,0x00},/*"Q",49*/
{0x10,0x04,0x1F,0xFC,0x11,0x04,0x11,0x00,0x11,0xC0,0x11,0x30,0x0E,0x0C,0x00,0x04},/*"R",50*/
{0x00,0x00,0x0E,0x1C,0x11,0x04,0x10,0x84,0x10,0x84,0x10,0x44,0x1C,0x38,0x00,0x00},/*"S",51*/
{0x18,0x00,0x10,0x00,0x10,0x04,0x1F,0xFC,0x10,0x04,0x10,0x00,0x18,0x00,0x00,0x00},/*"T",52*/
{0x10,0x00,0x1F,0xF8,0x10,0x04,0x00,0x04,0x00,0x04,0x10,0x04,0x1F,0xF8,0x10,0x00},/*"U",53*/
{0x10,0x00,0x1E,0x00,0x11,0xE0,0x00,0x1C,0x00,0x70,0x13,0x80,0x1C,0x00,0x10,0x00},/*"V",54*/
{0x1F,0xC0,0x10,0x3C,0x00,0xE0,0x1F,0x00,0x00,0xE0,0x10,0x3C,0x1F,0xC0,0x00,0x00},/*"W",55*/
{0x10,0x04,0x18,0x0C,0x16,0x34,0x01,0xC0,0x01,0xC0,0x16,0x34,0x18,0x0C,0x10,0x04},/*"X",56*/
{0x10,0x00,0x1C,0x00,0x13,0x04,0x00,0xFC,0x13,0x04,0x1C,0x00,0x10,0x00,0x00,0x00},/*"Y",57*/
{0x08,0x04,0x10,0x1C,0x10,0x64,0x10,0x84,0x13,0x04,0x1C,0x04,0x10,0x18,0x00,0x00},/*"Z",58*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x7F,0xFE,0x40,0x02,0x40,0x02,0x40,0x02,0x00,0x00},/*"[",59*/
{0x00,0x00,0x30,0x00,0x0C,0x00,0x03,0x80,0x00,0x60,0x00,0x1C,0x00,0x03,0x00,0x00},/*"\",60*/
{0x00,0x00,0x40,0x02,0x40,0x02,0x40,0x02,0x7F,0xFE,0x00,0x00,0x00,0x00,0x00,0x00},/*"]",61*/
{0x00,0x00,0x00,0x00,0x20,0x00,0x40,0x00,0x40,0x00,0x40,0x00,0x20,0x00,0x00,0x00},/*"^",62*/
{0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x01},/*"_",63*/
{0x00,0x00,0x40,0x00,0x40,0x00,0x20,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"`",64*/
{0x00,0x00,0x00,0x98,0x01,0x24,0x01,0x44,0x01,0x44,0x01,0x44,0x00,0xFC,0x00,0x04},/*"a",65*/
{0x10,0x00,0x1F,0xFC,0x00,0x88,0x01,0x04,0x01,0x04,0x00,0x88,0x00,0x70,0x00,0x00},/*"b",66*/
{0x00,0x00,0x00,0x70,0x00,0x88,0x01,0x04,0x01,0x04,0x01,0x04,0x00,0x88,0x00,0x00},/*"c",67*/
{0x00,0x00,0x00,0x70,0x00,0x88,0x01,0x04,0x01,0x04,0x11,0x08,0x1F,0xFC,0x00,0x04},/*"d",68*/
{0x00,0x00,0x00,0xF8,0x01,0x44,0x01,0x44,0x01,0x44,0x01,0x44,0x00,0xC8,0x00,0x00},/*"e",69*/
{0x00,0x00,0x01,0x04,0x01,0x04,0x0F,0xFC,0x11,0x04,0x11,0x04,0x11,0x00,0x18,0x00},/*"f",70*/
{0x00,0x00,0x00,0xD6,0x01,0x29,0x01,0x29,0x01,0x29,0x01,0xC9,0x01,0x06,0x00,0x00},/*"g",71*/
{0x10,0x04,0x1F,0xFC,0x00,0x84,0x01,0x00,0x01,0x00,0x01,0x04,0x00,0xFC,0x00,0x04},/*"h",72*/
{0x00,0x00,0x01,0x04,0x19,0x04,0x19,0xFC,0x00,0x04,0x00,0x04,0x00,0x00,0x00,0x00},/*"i",73*/
{0x00,0x00,0x00,0x03,0x00,0x01,0x01,0x01,0x19,0x01,0x19,0xFE,0x00,0x00,0x00,0x00},/*"j",74*/
{0x10,0x04,0x1F,0xFC,0x00,0x24,0x00,0x40,0x01,0xB4,0x01,0x0C,0x01,0x04,0x00,0x00},/*"k",75*/
{0x00,0x00,0x10,0x04,0x10,0x04,0x1F,0xFC,0x00,0x04,0x00,0x04,0x00,0x00,0x00,0x00},/*"l",76*/
{0x01,0x04,0x01,0xFC,0x01,0x04,0x01,0x00,0x01,0xFC,0x01,0x04,0x01,0x00,0x00,0xFC},/*"m",77*/
{0x01,0x04,0x01,0xFC,0x00,0x84,0x01,0x00,0x01,0x00,0x01,0x04,0x00,0xFC,0x00,0x04},/*"n",78*/
{0x00,0x00,0x00,0xF8,0x01,0x04,0x01,0x04,0x01,0x04,0x01,0x04,0x00,0xF8,0x00,0x00},/*"o",79*/
{0x01,0x01,0x01,0xFF,0x00,0x85,0x01,0x04,0x01,0x04,0x00,0x88,0x00,0x70,0x00,0x00},/*"p",80*/
{0x00,0x00,0x00,0x70,0x00,0x88,0x01,0x04,0x01,0x04,0x01,0x05,0x01,0xFF,0x00,0x01},/*"q",81*/
{0x01,0x04,0x01,0x04,0x01,0xFC,0x00,0x84,0x01,0x04,0x01,0x00,0x01,0x80,0x00,0x00},/*"r",82*/
{0x00,0x00,0x00,0xCC,0x01,0x24,0x01,0x24,0x01,0x24,0x01,0x24,0x01,0x98,0x00,0x00},/*"s",83*/
{0x00,0x00,0x01,0x00,0x01,0x00,0x07,0xF8,0x01,0x04,0x01,0x04,0x00,0x00,0x00,0x00},/*"t",84*/
{0x01,0x00,0x01,0xF8,0x00,0x04,0x00,0x04,0x00,0x04,0x01,0x08,0x01,0xFC,0x00,0x04},/*"u",85*/
{0x01,0x00,0x01,0x80,0x01,0x70,0x00,0x0C,0x00,0x10,0x01,0x60,0x01,0x80,0x01,0x00},/*"v",86*/
{0x01,0xF0,0x01,0x0C,0x00,0x30,0x01,0xC0,0x00,0x30,0x01,0x0C,0x01,0xF0,0x01,0x00},/*"w",87*/
{0x00,0x00,0x01,0x04,0x01,0x8C,0x00,0x74,0x01,0x70,0x01,0x8C,0x01,0x04,0x00,0x00},/*"x",88*/
{0x01,0x01,0x01,0x81,0x01,0x71,0x00,0x0E,0x00,0x18,0x01,0x60,0x01,0x80,0x01,0x00},/*"y",89*/
{0x00,0x00,0x01,0x84,0x01,0x0C,0x01,0x34,0x01,0x44,0x01,0x84,0x01,0x0C,0x00,0x00},/*"z",90*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x3E,0xFC,0x40,0x02,0x40,0x02},/*"{",91*/
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00},/*"|",92*/
{0x00,0x00,0x40,0x02,0x40,0x02,0x3E,0xFC,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"}",93*/
{0x00,0x00,0x60,0x00,0x80,0x00,0x80,0x00,0x40,0x00,0x40,0x00,0x20,0x00,0x20,0x00},/*"~",94*/
};   


type_2d_pixel    Arry_2d_pixel[0x52];
type_2d_matrix   Test_matrix = {0,0,0,Arry_2d_pixel};

//创建3D图形管理器 
//offsetx:x轴向的偏移
//offsety:y轴向的偏移
//offsetz:z轴向的偏移
//size:3D像素点的个数(每个占用14个字节)
_t3d_obj* t3d_creat(TU16 offsetx,TU16 offsety,TU16 offsetz,TU16 size) 
{
	TU8 res=0;
	_t3d_obj* t3d_crt;	  	
	t3d_crt=(_t3d_obj*)malloc(sizeof(_t3d_obj));//分配管理器的内存
	if(t3d_crt==NULL)return NULL;//内存分配不够.

	t3d_crt->p3dbuf=(type_3d_pixel*)malloc(sizeof(type_3d_pixel)*size);//分配3D像素点的内存
	if(t3d_crt->p3dbuf==NULL)res=1;//内存分配不够.
	t3d_crt->p2dbuf=(type_2d_pixel*)malloc(sizeof(type_2d_pixel)*size);//分配2D像素点的内存
	
	
	if(t3d_crt->p2dbuf==NULL)res=1;//内存分配不够.
	t3d_crt->ang.x=0;
	t3d_crt->ang.y=0;
	t3d_crt->ang.z=0;
	t3d_crt->dis.x=0;
	t3d_crt->dis.y=0;
	t3d_crt->dis.z=0;
	t3d_crt->pixsize=0;	  
	t3d_crt->maxpixsize=size;
	//坐标系偏移
	t3d_crt->offx=offsetx;
	t3d_crt->offy=offsety;
	t3d_crt->offz=offsetz;

	if(res)//创建失败
	{
		t3d_delete(t3d_crt);
		return NULL;
	}else return t3d_crt;//创建成功	  
}

//创建3D图形管理器 
//offsetx:x轴向的偏移
//offsety:y轴向的偏移
//offsetz:z轴向的偏移
//size:3D像素点的个数(每个占用14个字节)
T8 xt3d_creat(TU16 offsetx,TU16 offsety,TU16 offsetz,TU16 size,_t3d_obj* t3d_crt,void* p2dbuf,void* p3dbuf) 
{
		TU8 res=0;
		
		// t3d_crt=(_t3d_obj*)malloc(sizeof(_t3d_obj));//分配管理器的内存
		// if(t3d_crt==NULL)return NULL;//内存分配不够.
		 t3d_crt->p3dbuf = (type_3d_pixel*)p3dbuf;//分配3D像素点的内存
		 t3d_crt->p2dbuf = (type_2d_pixel*)p2dbuf;//分配2D像素点的内存
		
		
		if( t3d_crt->p2dbuf==NULL )res=1;//内存分配不够.
				t3d_crt->ang.x=0;
				t3d_crt->ang.y=0;
				t3d_crt->ang.z=0;
				t3d_crt->dis.x=0;
				t3d_crt->dis.y=0;
				t3d_crt->dis.z=0;
				t3d_crt->pixsize=0;	  
				t3d_crt->maxpixsize=size;
				//坐标系偏移
				t3d_crt->offx=offsetx;
				t3d_crt->offy=offsety;
				t3d_crt->offz=offsetz;

		return res;//创建成功	  
}

//删除一个3D管理器
void t3d_delete(_t3d_obj* t3d_del)
{
	free(t3d_del->p2dbuf);
	free(t3d_del->p3dbuf);
	free(t3d_del);
}
/////////////////////////////////////////////算法部分/////////////////////////////////
//查表发获得正弦值,正弦值扩大1024倍取整.
//arg:角度   (单位:0.1度)
//返回值:正弦值(扩大1024倍取整)
 TS16 my_sin(TS16 arg)
{
	if(arg<0)
	{	   	
		arg=-arg;
		arg=arg%3600;//周期总是0~360°
		if(arg<=900)return -sintbl[arg];
		else if(arg<=1800)return -sintbl[1800-arg];
		else if(arg<=2700)return sintbl[arg-1800];
		else return sintbl[3600-arg];
	}else
	{
		arg=arg%3600;//周期总是0~360°
		if(arg<=900)return sintbl[arg];
		else if(arg<=1800)return sintbl[1800-arg];
		else if(arg<=2700)return -sintbl[arg-1800];
		else return -sintbl[3600-arg];
	}
}
//查表发获得余弦值,余弦值扩大1024倍取整.
//arg:角度   (单位:0.1度)
//返回值:余弦值(扩大1024倍取整)
TS16 my_cos(TS16 arg)
{
	if(arg<0)arg=-arg;//转换为正数
	arg=arg%3600;//周期总是0~360°
	if(arg<=900)return sintbl[900-arg];
	else if(arg<=1800)return -sintbl[arg-900];
	else if(arg<=2700)return -sintbl[2700-arg];
	else return sintbl[arg-2700];
} 
//核心算法部分
//3d转2D函数, pangle-旋转角度，ptrandis-移动位置, ppixel－要转换的像素, ppreturn-转换后的2D值保存到这
//pangle:角度.单位为弧度,而不是°.如果要用度表示的话,需要乘以π/180
//ptrandis:移动位置(当前点所围绕操作的点的坐标,3D像素点)
//ppixel:要转换的像素点(3D像素点)
//ppreturn:转换完成后的像素点(2D像素点)		 
void t3d_pixel_transform(_t3d_obj* t3dx,TU16 pixindex)
{		 
	signed long lsinx,lcosx,lsiny,lcosy,lsinz,lcosz;
	signed long ltempx,ltempy,ltempz;
	signed long ldx,ldy,ldz; 	  
    float tdx,tdy;//必须要的2个个浮点数据,否则在x/y轴上会有点问题.	  
	
	lsinx=my_sin(t3dx->ang.x);
 	lcosx=my_cos(t3dx->ang.x);
	lsiny=my_sin(t3dx->ang.y);
	lcosy=my_cos(t3dx->ang.y);
	lsinz=my_sin(t3dx->ang.z);
 	lcosz=my_cos(t3dx->ang.z); 
    //开始计算和转换 
    ldx = t3dx->p3dbuf[pixindex].x;
	ldy = t3dx->p3dbuf[pixindex].y;
	ldz = t3dx->p3dbuf[pixindex].z;
    ltempy = ldy*lcosx - ldz*lsinx;
    ltempz = ldy*lsinx + ldz*lcosx;	
    ldy = ltempy;
    ldz = ltempz;
    ltempx = ldx*lcosy*1000 - ldz*lsiny;	
    ltempz = ldx*lsiny*1000 + ldz*lcosy;	
    ldx = ltempx/1000;			  
    ldz = ltempz/10000;//得到扩大100倍的结果
    ltempx = ldx * lcosz - ldy * lsinz;	
    ltempy = ldx * lsinz + ldy * lcosz;	
    ldx = ltempx/100000;
    ldy = ltempy/100000;	  
    tdx = ldx + t3dx->dis.x*10;
	tdy = ldy + t3dx->dis.y*10;
	ldz = ldz - t3dx->dis.z*100 + t3dx->offz*100;	   
 	t3dx->p2dbuf[pixindex].x = (((tdx-USRX)*USRZ)/ldz) + t3dx->offx;
	t3dx->p2dbuf[pixindex].y = (((tdy-USRY)*USRZ)/ldz) + t3dx->offy;    
	t3dx->p2dbuf[pixindex].color=t3dx->p3dbuf[pixindex].color;    
  
}  
/////////////////////////////////////////////////////////////////////////////////////
//坐标系从做到右,从上到下.	    

//在指定位置显示一个字符
//这里的坐标是3D坐标
//t3dx:3d物体
//x,y,z:3d坐标系坐标.
//num:要显示的字符:" "--->"~"
//size:字体大小 12/16	
//color:文字颜色			  
void t3d_show_char(_t3d_obj *t3dx,TS16 x,TS16 y,TS16 z,TU8 num,TU8 size,TU16 color)
{  		    
    TU8 temp;
    TU8 t,t1; 	   					      				  
	TS16 y0=y;
	//设置窗口		   
	num=num-' ';//得到偏移后的值  
    for(t=0;t<size;t++)
    {   
		if(size==12)temp=asc2_1206[num][t];  //调用1206字体
		else temp=asc2_1608[num][t];		 //调用1608字体 	                          
        for(t1=0;t1<8;t1++)
		{			    
	        if(temp&0x80)
			{	   
				t3dx->p3dbuf[t3dx->pixsize].x=x;
				t3dx->p3dbuf[t3dx->pixsize].y=y; 
				t3dx->p3dbuf[t3dx->pixsize].z=z;	  
				t3dx->p3dbuf[t3dx->pixsize].color=color;
				t3dx->pixsize++;    
			}
			temp<<=1;
			y++;
			if((y-y0)==size)
			{
				y=y0;
				x++;
				break;
			}
		}  	 
    } 					     	   	 	  
}
//在指定位置显示一个字符串
//这里的坐标是3D坐标
//t3dx:3d物体
//x,y,z:3d坐标系坐标.
//p:字符串指针
//size:字体大小 12/16	
//ctbl:文字颜色表,每个字符一个颜色
//mode:模式.1,用颜色表.0,不用颜色表,所有的都是一个颜色.
void t3d_show_str(_t3d_obj *t3dx,TS16 x,TS16 y,TS16 z,const TU8 *p,TU8 size,TU16 *ctbl,TU8 mode)
{         
    while(*p!='\0')
    {       
        if(x>239)
			break;		
		t3d_show_char(t3dx,x,y,z,*p,size,*ctbl);							 
        if(mode!=0)
			ctbl++;//用颜色表	  
		x+=size/2;
        p++;
    }  
}   

//在2维坐标系画点
//这里的坐标是LCD坐标,不是3D坐标
//x,y:坐标
//color:点的颜色
void t2d_draw_point(TU16 x,TU16 y,TU16 color)
{

	xOLED_DrawPoint(x,y,color); 
} 
//在3d空间画一个点
//这里的坐标是3D坐标
//t3dx:3d物体
//pixindex:像素编号
//x,y,z:三维空间的坐标
//color:点的颜色
void t3d_draw_point(_t3d_obj *t3dx,TU16 pixindex,TS16 x,TS16 y,TS16 z,TU16 color)
{	  
 	t3dx->p3dbuf[pixindex].x=x;
	t3dx->p3dbuf[pixindex].y=y; 
	t3dx->p3dbuf[pixindex].z=z;
	t3dx->p3dbuf[pixindex].color=color; 

 	t3d_pixel_transform(t3dx,pixindex);//坐标转换
 	t2d_draw_point(t3dx->p2dbuf[pixindex].x,t3dx->p2dbuf[pixindex].y,t3dx->p2dbuf[pixindex].color);
}
//在指定区域显示一个3D物体.
//这里的坐标是LCD坐标,不是3D坐标
//x,y,width,height:显示区域设定
//t3dx:3d物体
//bkcolor:背景色.
//显示时,先清除上一次的显示,然后再显示新的
void t3d_show_obj(TU16 x,TU16 y,TU16 width,TU16 height,_t3d_obj *t3dx,TU16 bkcolor)
{
		TU16 i;
		width+=x;
		height+=y;
		for(i=0;i<t3dx->pixsize;i++)
		{																								 
			if( t3dx->p2dbuf[i].x<width&&t3dx->p2dbuf[i].x>=x&&t3dx->p2dbuf[i].y<height&&t3dx->p2dbuf[i].y>=y)//在设定区域内.
					t2d_draw_point(t3dx->p2dbuf[i].x, t3dx->p2dbuf[i].y,bkcolor);					//清除上一次的图形像素
			
			t3d_pixel_transform(t3dx,i);	//坐标转换		  
			if(t3dx->p2dbuf[i].x<width&&t3dx->p2dbuf[i].x>=x&&t3dx->p2dbuf[i].y<height&&t3dx->p2dbuf[i].y>=y)//在设定区域内.
					t2d_draw_point(t3dx->p2dbuf[i].x,t3dx->p2dbuf[i].y,t3dx->p2dbuf[i].color);		//画新的图形像素
		}
}  
//清除上一次的图像
//这里的坐标是LCD坐标,不是3D坐标
//x,y,width,height:显示区域设定
//t3dx:3d物体
//bkcolor:背景色.
void t3d_clear_obj(TU16 x,TU16 y,TU16 width,TU16 height,_t3d_obj *t3dx,TU16 bkcolor)
{
	TU16 i;
	width+=x;
	height+=y;
	for(i=0;i<t3dx->pixsize;i++)
	{
		if(t3dx->p2dbuf[i].x<width&&t3dx->p2dbuf[i].x>=x&&t3dx->p2dbuf[i].y<height&&t3dx->p2dbuf[i].y>=y)//在设定区域内.
		t2d_draw_point(t3dx->p2dbuf[i].x, t3dx->p2dbuf[i].y,bkcolor);					//清除上一次的图形像素
	}
}
/////////////////////////////////////////////////////////////////////
   


TU16 frame=0;

//void test_3d(TU16 x,TU16 y,TU8 *str)
//{
//	TU16 i;
//	_t3d_obj *t3dx;
////	TU8 pause=0;
//	TU8 key;
//	TS16 slen=strlen((const TS8*)str);
//	LCD_Clear(0);
// 	slen*=-4;
//	
//	t3d_show_str(t3dx,slen+x,y,0,str,16,RED);
//
//	while(1)		
//	{			   	 
//		 frame++;
// 		 //t3dx->ang.x+=1;
// 		 //t3dx->ang.z+=1;
// 		 //t3dx->ang.y+=1;				   
//		 while(0)
//		 {				 
//		 	key=KEY_Scan(1);
//		 	if(key==1)
//			{
//				t3dx->ang.x+=10;
//				printf("x:%d\r\n",(TS16)t3dx->ang.x);
//				break;
//			}		    
//		 	if(key==2)
//			{
//				t3dx->ang.y+=10;
//				printf("y:%d\r\n",(TS16)t3dx->ang.y);
//				break;
//			}
//		 	if(key==3)
//			{
//				t3dx->ang.z+=10;
//				printf("z:%d\r\n",(TS16)t3dx->ang.z);
//				break;
//			}
//		 }
//
//		
//	}
//} 

















//画立方体的边框
//t3dx:3D体
//color:线条颜色
void t3dplay_draw_cube_rim(_t3d_obj* t3dx,TU16 color)
{
   	xOLED_DrawLine(t3dx->p2dbuf[0].x,t3dx->p2dbuf[0].y,t3dx->p2dbuf[1].x,t3dx->p2dbuf[1].y,color);//画线
  	xOLED_DrawLine(t3dx->p2dbuf[0].x,t3dx->p2dbuf[0].y,t3dx->p2dbuf[3].x,t3dx->p2dbuf[3].y,color);//画线
 	xOLED_DrawLine(t3dx->p2dbuf[0].x,t3dx->p2dbuf[0].y,t3dx->p2dbuf[4].x,t3dx->p2dbuf[4].y,color);//画线
 	xOLED_DrawLine(t3dx->p2dbuf[2].x,t3dx->p2dbuf[2].y,t3dx->p2dbuf[1].x,t3dx->p2dbuf[1].y,color);//画线
 	xOLED_DrawLine(t3dx->p2dbuf[2].x,t3dx->p2dbuf[2].y,t3dx->p2dbuf[3].x,t3dx->p2dbuf[3].y,color);//画线
 	xOLED_DrawLine(t3dx->p2dbuf[2].x,t3dx->p2dbuf[2].y,t3dx->p2dbuf[6].x,t3dx->p2dbuf[6].y,color);//画线
 	xOLED_DrawLine(t3dx->p2dbuf[5].x,t3dx->p2dbuf[5].y,t3dx->p2dbuf[1].x,t3dx->p2dbuf[1].y,color);//画线
 	xOLED_DrawLine(t3dx->p2dbuf[5].x,t3dx->p2dbuf[5].y,t3dx->p2dbuf[6].x,t3dx->p2dbuf[6].y,color);//画线
 	xOLED_DrawLine(t3dx->p2dbuf[5].x,t3dx->p2dbuf[5].y,t3dx->p2dbuf[4].x,t3dx->p2dbuf[4].y,color);//画线
  	xOLED_DrawLine(t3dx->p2dbuf[7].x,t3dx->p2dbuf[7].y,t3dx->p2dbuf[3].x,t3dx->p2dbuf[3].y,color);//画线
 	xOLED_DrawLine(t3dx->p2dbuf[7].x,t3dx->p2dbuf[7].y,t3dx->p2dbuf[6].x,t3dx->p2dbuf[6].y,color);//画线
 	xOLED_DrawLine(t3dx->p2dbuf[7].x,t3dx->p2dbuf[7].y,t3dx->p2dbuf[4].x,t3dx->p2dbuf[4].y,color);//画线
}  
//画一个3d立方体
//t3dx:3D体
//color:线条颜色.
//bkcolor:背景颜色.
void t3dplay_draw_cube(_t3d_obj* t3dx,TU16 color,TU16 bkcolor)
{	 		 
	t3dplay_draw_cube_rim(t3dx,bkcolor); 
	//t3d_show_obj(10,80,220,220,t3dx,bkcolor);	//先显示点.
	t3d_show_obj((128-20)/2,80+(64-20)/2,128-20,64-20,t3dx,bkcolor);	//先显示点.
	t3dplay_draw_cube_rim(t3dx, color);
}	 

/*

A7 B7 C7 D7
A6 B6 C6 D6
A5 B5 C5 D5
A4 B4 C4 D4
A3 B3 C3 D3
A2 B2 C2 D2
A1 B1 C1 D1
A0 B0 C0 D0



type_2d_pixel  matrix_2d_pixel



*/

unsigned int DrawPic( type_2d_matrix *  matrix, TU8 *Data,TU16 x, TU16 y, TU16 color ){

		TU16 i,j,k;
	//	TU16 index;
		TU8  tBYTE = 0;
		if( matrix && matrix->p2d_pixel ){
				matrix->xoffsize = x;
				matrix->yoffsize = y;
				matrix->validindex = 0;
				for( i=0; i<y/8; i++ ){//字节行数
						for( j=0; j<x; j++ ){//列数        
								tBYTE = Data[i*x+j];
								for( k=0; k<8; k++ ){//像素数
									if(tBYTE&0x80){
										matrix->p2d_pixel[ matrix->validindex ].x = j;
										matrix->p2d_pixel[ matrix->validindex ].y = i*8+k;
										matrix->p2d_pixel[ matrix->validindex ].color =  color;
										matrix->validindex++;    
									}
									tBYTE<<=1;		
								}
						}
				}
				return matrix->validindex;
		}
		return 0xffff;				  				  			  
}

void DrawMatrix( type_2d_matrix *  matrix , _t3d_obj* t3dx, TU8 Flat,int X,int Y,int Z){
	TU16 index;

	if( matrix && matrix->p2d_pixel && t3dx ){
		switch(Flat){
			case FLAT_XY:{
				for( index=0; index<matrix->validindex; index++ ){//字节行数
//			 POINT_COLOR = matrix->p2d_pixel[index].color;
//			 LCD_DrawPoint(matrix->p2d_pixel[index].x,matrix->p2d_pixel[index].y);
				
				
					t3dx->p3dbuf[t3dx->pixsize].x=matrix->p2d_pixel[index].x+X;
					t3dx->p3dbuf[t3dx->pixsize].y=matrix->p2d_pixel[index].y+Y; 
					t3dx->p3dbuf[t3dx->pixsize].z=Z;	  
					t3dx->p3dbuf[t3dx->pixsize].color=matrix->p2d_pixel[index].color;
					t3dx->pixsize++;  
				}	
			}
			break;
			case FLAT_YX:{
				for( index=0; index<matrix->validindex; index++ ){//字节行数
//			 POINT_COLOR = matrix->p2d_pixel[index].color;
//			 LCD_DrawPoint(matrix->p2d_pixel[index].x,matrix->p2d_pixel[index].y);
				
				
					t3dx->p3dbuf[t3dx->pixsize].x=matrix->p2d_pixel[index].y+Y;
					t3dx->p3dbuf[t3dx->pixsize].y=matrix->p2d_pixel[index].x+X; 
					t3dx->p3dbuf[t3dx->pixsize].z=Z;	  
					t3dx->p3dbuf[t3dx->pixsize].color=matrix->p2d_pixel[index].color;
					t3dx->pixsize++;  
				}	
			}
			break;
			case FLAT_XZ:{
				for( index=0; index<matrix->validindex; index++ ){//字节行数
//			 POINT_COLOR = matrix->p2d_pixel[index].color;
//			 LCD_DrawPoint(matrix->p2d_pixel[index].x,matrix->p2d_pixel[index].y);
				
				
					t3dx->p3dbuf[t3dx->pixsize].x=matrix->p2d_pixel[index].x+X;
					t3dx->p3dbuf[t3dx->pixsize].y=Z;                        
					t3dx->p3dbuf[t3dx->pixsize].z=matrix->p2d_pixel[index].y+Y;	  
					t3dx->p3dbuf[t3dx->pixsize].color=matrix->p2d_pixel[index].color;
					t3dx->pixsize++;  
				}
			}
			break;
			case FLAT_ZX:{
				for( index=0; index<matrix->validindex; index++ ){//字节行数
//			 POINT_COLOR = matrix->p2d_pixel[index].color;
//			 LCD_DrawPoint(matrix->p2d_pixel[index].x,matrix->p2d_pixel[index].y);
				
				
					t3dx->p3dbuf[t3dx->pixsize].x=matrix->p2d_pixel[index].y+Y;
					t3dx->p3dbuf[t3dx->pixsize].y=Z;                        
					t3dx->p3dbuf[t3dx->pixsize].z=matrix->p2d_pixel[index].x+X;	  
					t3dx->p3dbuf[t3dx->pixsize].color=matrix->p2d_pixel[index].color;
					t3dx->pixsize++;  
				}	
			}
			break;
			case FLAT_YZ:{
				for( index=0; index<matrix->validindex; index++ ){//字节行数
//			 POINT_COLOR = matrix->p2d_pixel[index].color;
//			 LCD_DrawPoint(matrix->p2d_pixel[index].x,matrix->p2d_pixel[index].y);
				
				
					t3dx->p3dbuf[t3dx->pixsize].x=Z; 
					t3dx->p3dbuf[t3dx->pixsize].y=matrix->p2d_pixel[index].x+X;
					t3dx->p3dbuf[t3dx->pixsize].z=matrix->p2d_pixel[index].y+Y;	  
					t3dx->p3dbuf[t3dx->pixsize].color=matrix->p2d_pixel[index].color;
					t3dx->pixsize++;  
				}	
			}
			break;
			case FLAT_ZY:{
				for( index=0; index<matrix->validindex; index++ ){//字节行数
//			 POINT_COLOR = matrix->p2d_pixel[index].color;
//			 LCD_DrawPoint(matrix->p2d_pixel[index].x,matrix->p2d_pixel[index].y);
				
				
					t3dx->p3dbuf[t3dx->pixsize].x=Z; 
					t3dx->p3dbuf[t3dx->pixsize].y=matrix->p2d_pixel[index].y+Y;
					t3dx->p3dbuf[t3dx->pixsize].z=matrix->p2d_pixel[index].x+X;	  
					t3dx->p3dbuf[t3dx->pixsize].color=matrix->p2d_pixel[index].color;
					t3dx->pixsize++;  
				}	
			}
			break;
			
			
		}
	}
}

